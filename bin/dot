#!/bin/bash -e

##########################
# install and update :^) #
##########################

cd "$HOME/.dotfiles"

# if we have git and no changes to the local dotfiles repo, pull in from upstream
# before running our update
if [[ -x "$(command -v git)" ]] && [[ -x ".git" ]] && [[ -z "$(git diff-index HEAD --)" ]]
then
  git pull
fi

if [[ "$(uname -s)" == "Darwin" ]]
then
  # enforce our system defaults
  ./mac/set-defaults.sh

  # install homebrew if it's not available
  ./homebrew/install.sh 2>&1

  # upgrade homebrew
  brew update
fi

# install software as needed
./script/install
